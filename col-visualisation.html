<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Collagen sequence display and highlighting tool</title>
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js">
</script>
<![endif]-->
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css" />
<style>
body {font-family: Verdana, sans-serif; font-size:0.8em;}
header, nav, section, footer {border:1px solid grey; margin:5px; padding:8px;}
nav ul {margin:0; padding:0;}
nav ul li {display:inline; margin:5px;}
p.outputchains  {
  /*color:green;*/
  font-family: Courier New,Courier;
  font-size:15pt;
  margin:0;
	  }
.red {color:red;}
.highlight {color:red;}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
<script src="jquery.myhighlight-3.min.js"></script>
</head>

<body>

<header>
<h1>Collagen sequence display and highlighting tool</h1>

</header>

<section>
<h2>Input sequences here</h2>

<p>Type your sequence into the box.</p>

<article id="input">
  Leading chain:<br />
  <textarea class="inputchain" rows="4" cols="100">GPOGPOGPO</textarea>
  <br />
  Middle chain:<br />
  <textarea class="inputchain" rows="4" cols="100">GPOGPOGPO</textarea>
  <br />
  Lagging chain:<br />
  <textarea class="inputchain" rows="4" cols="100">GPOGPOGPO</textarea>
  <br />
</article>
  Number of residues to stagger:
  <input type="number" id="stagger" min="0" value="1" onchange="displayFunction()"/>
  <br />
<!--
  Swap chain <input type="number" id="swap1" min="1" max="3" value="1" /> with
  chain <input type="number" id="swap2" min="1" max="3" value="1" />
  <button type="button" onclick = "swapChains()">swap chains</button>
-->

</section>

<section>
<h2>Get output here</h2>

<article id="results"></article>

</section>

<!--
  <br />
 <button type="button" 
  onclick = "tidyDisplay()">
  Tidy</button>
-->

<section>

<h2>Highlight residues</h2>
<ul>
  <li>Use one letter code.</li>
  <li>All input will be automatically capitalised.</li>
  <li>Some regex works. 
  <ul>
    <li><strong>GP</strong> finds exactly "GP" (G <emph>and</emph> P in that order).</li>
    <li>For G or P, use <strong>[GP]</strong>.</li>
    <li><strong>[A-Z]</strong> (square brackets included) matches any one residue.</li>
    <li>For G followed by something, use <strong>G[A-Z]</strong>.</li>
  </ul>
</ul> 
Specify residues to be highlighted:
<input type="text" id="selector" value="G" />
<button type="button" onclick ="highlightFunction()">Highlight</button>
<button type="button" onclick ="$('#results').removeHighlight()">Remove Highlight</button>
<br />
<!--
Select highlight colour (doesn't do anything yet):
<input type="color" id="highlightcol" value="#ff0000" />
-->
<br />
<article id="testingresults"></article>

</section>


<script>
$( document ).ready(function() {
   displayFunction();
});

$('.inputchain').keyup(displayFunction);

function displayFunction() {
    $('#results').empty();
    
    $('.inputchain').each(function(index) {
        var outputChain = $('<p></p>').addClass('outputchains');
        var chains = $(this).val().toUpperCase();
        outputChain.append(new Array(index + 1).join(staggerSpacer()) + chains);
        $('#results').append(outputChain);
    });
}

function staggerSpacer() {
    var stagger = parseInt($("#stagger").val());
    var staggerspace = new Array(stagger+1).join('-');
    return staggerspace;
}

function swapChains() {
    var x = parseInt(document.getElementById("swap1").value)-1;
    var y = parseInt(document.getElementById("swap2").value)-1;
    
    var chains = document.getElementsByClassName("inputchain");
    chains[x].className = chains[x].className +" red";
}

$('#selector').keyup(processAsYouType);

function processAsYouType(){
    if (this.value != '') {    
    this.value = this.value.toUpperCase();
    //~ highlightFunction();  //crashes too easily 
  }
};

function highlightFunction() {
    $('#results').removeHighlight();
    var selector = "("+$("#selector").val()+")";
    $("#results").highlight(selector);
}



</script>


</body>
</html>
